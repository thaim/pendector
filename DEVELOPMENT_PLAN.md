# Pendector 開発計画

## プロジェクト概要
ローカルリポジトリの変更を検出・管理するRust製CLIツール

## 現在の状態 (2025-08-02)
- ✅ Phase 1 完了: 基盤構築
- ✅ Phase 2 完了: Git統合
- 🔄 Phase 3 進行中: CLI機能拡張 (一部完了)
- ⏳ Phase 4 未着手: 高度な機能

## コア機能

### 1. リポジトリ検出
- ローカルの.gitディレクトリを再帰的に検索
- 設定可能なベースディレクトリ

### 2. 変更状態チェック
- `git status`で未コミット変更を検出
- ブランチ状態確認
- リモートとの同期状態

### 3. 結果表示
- 変更のあるリポジトリ一覧
- 詳細情報（ファイル数、ブランチ名等）
- カラー出力対応

### 4. フィルタリング
- 特定のパターンでリポジトリを絞り込み
- 変更の種類別フィルタ

## アーキテクチャ

```
src/
├── main.rs          # CLI エントリーポイント
├── lib.rs           # ライブラリルート
├── cli/
│   └── mod.rs       # CLI コマンド定義
├── core/
│   ├── mod.rs       # コアロジック
│   ├── repo.rs      # リポジトリ構造体・操作
│   └── scanner.rs   # ディレクトリスキャン
├── git/
│   ├── mod.rs       # Git操作
│   └── status.rs    # ステータス取得
└── output/
    ├── mod.rs       # 出力フォーマット
    └── formatter.rs # 結果の整形・表示
```

## 必要な依存関係
- `walkdir`: ディレクトリ再帰探索
- `git2`: Git操作
- `colored`: カラー出力
- `serde`: 設定ファイル対応

## 実装フェーズ

### Phase 1: 基盤構築 ✅ 完了
1. ✅ 依存関係追加 (walkdir, git2, colored, serde)
2. ✅ モジュール構造作成 (cli/, core/, git/, output/)
3. ✅ 基本的なRepository構造体定義
4. ✅ ディレクトリスキャン機能 (深度制限付き)
5. ✅ 統合テスト作成 (7テスト)

### Phase 2: Git統合 ✅ 完了
1. ✅ git statusコマンド実行 (git2使用)
2. ✅ 変更検出ロジック
3. ✅ ブランチ情報取得
4. ✅ 基本的な出力機能
5. ✅ 単体テスト追加 (24テスト)

### Phase 3: CLI機能拡張 🔄 進行中
1. ✅ コマンドラインオプション追加 (paths, changes-only, verbose, max-depth)
2. ✅ フィルタリング機能 (changes-only)
3. ✅ カラー出力対応
4. ✅ 詳細表示モード (verbose)

#### Phase 3 残タスク:
- JSON出力フォーマット対応
- より高度なフィルタリングオプション

### Phase 4: 高度な機能 (1-2週間)
1. 設定ファイル対応
2. 除外パターン
3. 並列処理最適化
4. エラーハンドリング強化

## マイルストーン

- **M1 (Phase 1完了)** ✅: 基本的なリポジトリ検出ができる
- **M2 (Phase 2完了)** ✅: Git変更を検出し、コンソールに出力できる
- **M3 (Phase 3完了)** 🔄: 実用的なCLIツールとして使用可能 (ほぼ完了)
- **M4 (Phase 4完了)** ⏳: 高機能でユーザーフレンドリーなツール

## 次のステップ
Phase 3の残タスクとPhase 4の優先機能を実装:
1. JSON出力フォーマット
2. 設定ファイル対応
3. 除外パターン機能
4. 並列処理最適化